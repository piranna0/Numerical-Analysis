function d = beam1(n)

d = ones(n,1)/n^4;

U = [2 -2 1 0 0 0 0 0; 0 1 -2 1 0 0 0 0; 0 0 1 -2 1 0 0 0; 0 0 0 1 -2 1 0 0 ;
   0 0 0 0 1 -2 1 0 ; 0 0 0 0 0 1 -2 1 ; 0 0 0 0 0 0 1 -2; 0 0 0 0 0 0 0 1 ]
Ut = U';

%y = inv(U') * b
blah = Ut \ d
d(1) = d(1) / 2;
d(2) = d(2) + 2 * d(1);
for i = 3 : n
    d(i) = d(i) + 2 * d(i - 1) - d(i-2);
end

% x = inv(U) * y
blah2 = U \ d

d(n - 1) = 2 * d(n) + d(n - 1);
for i = n : 2
    d(i) = d(i)  d(i)

d(1) = (2 * d(2) - d(3)) / 2 