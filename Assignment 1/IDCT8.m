function Y = IDCT8(X)
% X is an 8-by-m matrix
% Y satisfies C*Y = X where C is the 8-by-8 DCT matrix.

Y=X;
%D*X
Y(2:8,:) = Y(2:8,:) * 1./4.;
Y(1,:) = Y(1,:) * 1./8.;

%T3'*Y
C = cos(pi * (1:7)/16);
row1 = [1 C(4)];
row2 = [1 -C(4)];
row3 = [C(2) C(6)];
row4 = [C(6) -C(2)];
row5 = [C(1) C(3) C(5) C(7)];
row6 = [C(3) -C(7) -C(1) -C(5)];
row7 = [C(5) -C(1) C(7) C(3)];
row8 = [C(7) -C(5) C(3) -C(1)];

Y(:,:) = [row1 * Y([1 5], :) ; row2 * Y([1 5], :) ; 
          row3 * Y([3 7], :) ; row4 * Y([3 7], :) ; 
          row5 * Y([2 4 6 8], :) ; row6 * Y([2 4 6 8], :) ; 
          row7 * Y([2 4 6 8], :) ; row8 * Y([2 4 6 8], :) ];
%T2' * Y
Y(1:4,:) = [Y(1,:) + Y(3,:) ; Y(2,:) + Y(4,:) ; Y(2,:) - Y(4,:) ; Y(1,:) - Y(3,:)];

%T1' * Y
Y(:,:) = [Y(1,:) + Y(5,:) ; Y(2,:) + Y(6,:) ; Y(3,:) + Y(7,:) ; Y(4,:) + Y(8,:) ;
          Y(4,:) - Y(8,:) ; Y(3,:) - Y(7,:) ; Y(2,:) - Y(6,:) ; Y(1,:) - Y(5,:) ];