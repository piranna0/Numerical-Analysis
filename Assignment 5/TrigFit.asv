function [A,B] = TrigFit(t,y,N,P)
m = length(t)

%Y_n is a m*N x 2*N matrix
Y_n = zeros(m*N, 2*N);
for j = 1:N
    Y_n(:, j*2-1:j*2) = [cos(2*pi*j*t/P) sin(2*pi*j*t/P)];
end

[Q,R] = qr(Y_n);